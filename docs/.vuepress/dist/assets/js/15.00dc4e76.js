(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{561:function(t,a,s){"use strict";s.r(a);var r=s(9),n=Object(r.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"整体思路"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#整体思路"}},[t._v("#")]),t._v(" 整体思路")]),t._v(" "),s("p",[t._v("   gma 提供栅格读取、处理等操作过程，并提供标准化的栅格处理思路，方便自主进行栅格数据运算等操作。基于 gma 的栅格运算标准思路和流程如下图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/explore/RasterOperation.svg",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"栅格运算"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#栅格运算"}},[t._v("#")]),t._v(" 栅格运算")]),t._v(" "),s("p",[t._v("   基于 "),s("strong",[t._v("整体思路")]),t._v("，这里简单实现栅格运算 "),s("em",[t._v("（下载 "),s("a",{attrs:{href:"/Open/ELE_China_GEBCO_2020.tif"}},[t._v("示例栅格")]),t._v("）（GEBCO 2020 年海洋与陆地地形）")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" gma\nInFile "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ELE_China_GEBCO_2020.tif'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h3",{attrs:{id:"打开文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#打开文件"}},[t._v("#")]),t._v(" 打开文件")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("DataSet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gma"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Open"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("InFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"获取属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取属性"}},[t._v("#")]),t._v(" 获取属性")]),t._v(" "),s("p",[t._v("   为方便运算后结果生成 GTiff 时添加属性，这里记录一下原始数据属性。可获取的属性参考 "),s("RouterLink",{attrs:{to:"/UserGuide/other/DataSet.html"}},[t._v("DataSet")]),t._v("。\n这里记录 "),s("strong",[t._v("坐标系/投影（Projection）、仿射变换（GeoTransform）、驱动格式（Driver）以及无数据标记值（NoData）")]),t._v("。")],1),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Proj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DataSet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Projection\nGeot "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DataSet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GeoTransform\nDriver "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DataSet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Driver \nNoData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DataSet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NoData \n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"读取数据为数组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#读取数据为数组"}},[t._v("#")]),t._v(" 读取数据为数组")]),t._v(" "),s("p",[t._v("   返回 array，方便结合 numpy、scipy、sklearn、pytorch 等其他库进行分析运算。")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DataSet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ToArray"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"简单归一化运算"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单归一化运算"}},[t._v("#")]),t._v(" "),s("em",[t._v("*简单归一化运算")])]),t._v(" "),s("p",[t._v("   这里对整个 array 进行一个简单的归一化运算，归一化方法如下：")]),t._v(" "),s("p"),s("p",[s("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML",display:"true"}},[s("mjx-math",{staticClass:" MJX-TEX",attrs:{display:"true"}},[s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"N"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"D"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"D"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"t"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-mo",{staticClass:"mjx-n",attrs:{space:"4"}},[s("mjx-c",{attrs:{c:"="}})],1),s("mjx-mfrac",{attrs:{space:"4"}},[s("mjx-frac",{attrs:{type:"d"}},[s("mjx-num",[s("mjx-nstrut",{attrs:{type:"d"}}),s("mjx-mrow",[s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"D"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"t"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[s("mjx-c",{attrs:{c:"2212"}})],1),s("mjx-mi",{staticClass:"mjx-i",attrs:{space:"3"}},[s("mjx-c",{attrs:{c:"D"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"t"}})],1),s("mjx-msub",[s("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[s("mjx-TeXAtom",{attrs:{size:"s"}},[s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"m"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"i"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"n"}})],1)],1)],1)],1)],1)],1),s("mjx-dbox",[s("mjx-dtable",[s("mjx-line",{attrs:{type:"d"}}),s("mjx-row",[s("mjx-den",[s("mjx-dstrut",{attrs:{type:"d"}}),s("mjx-mrow",[s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"D"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"t"}})],1),s("mjx-msub",[s("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[s("mjx-TeXAtom",{attrs:{size:"s"}},[s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"m"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"x"}})],1)],1)],1)],1),s("mjx-mo",{staticClass:"mjx-n",attrs:{space:"3"}},[s("mjx-c",{attrs:{c:"2212"}})],1),s("mjx-mi",{staticClass:"mjx-i",attrs:{space:"3"}},[s("mjx-c",{attrs:{c:"D"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"t"}})],1),s("mjx-msub",[s("mjx-mi",{staticClass:"mjx-i",attrs:{noIC:"true"}},[s("mjx-c",{attrs:{c:"a"}})],1),s("mjx-script",{staticStyle:{"vertical-align":"-0.15em"}},[s("mjx-TeXAtom",{attrs:{size:"s"}},[s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"m"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"i"}})],1),s("mjx-mi",{staticClass:"mjx-i"},[s("mjx-c",{attrs:{c:"n"}})],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)],1),s("p"),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 记录有效数据位置")]),t._v("\nDLOC "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" NoData \n\nDMax "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("DLOC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("max")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nDMin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("DLOC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("min")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nNDData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" DMin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DMax "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" DMin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将无数据区域重新标记为 NoData")]),t._v("\nNDData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" NoData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" NoData\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"title"},[t._v("注意")]),s("p",[t._v("若输入数据包含 NoData，则此处运算时一定要忽略 NoData。因为此值作为填充值，不为有效数据，仅作占位使用！")])]),s("h3",{attrs:{id:"输出结果到新文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#输出结果到新文件"}},[t._v("#")]),t._v(" 输出结果到新文件")]),t._v(" "),s("div",{staticClass:"language-python line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("gma"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rasp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WriteRaster"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./ELE_China_GEBCO_2020_ND.tif'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                     NDData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                     Projection "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Proj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                     Transform "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Geot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                     Format "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                     DataType "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Float32'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                     NoData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" NoData "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("p",[s("img",{attrs:{src:"/explore/NDDEM.webp",alt:""}})])])}),[],!1,null,null,null);a.default=n.exports}}]);